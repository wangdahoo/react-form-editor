!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("antd/es/layout"),require("react"),require("react-dnd"),require("react-dnd-html5-backend"),require("antd/es/modal"),require("antd/es/button"),require("mobx-react"),require("antd/es/divider"),require("antd/es/empty"),require("antd/es/input-number"),require("antd/es/checkbox"),require("antd/es/select"),require("antd/es/input"),require("antd/es/radio"),require("antd/es/message"),require("mobx"),require("shortid"),require("immutability-helper"),require("classnames"),require("antd/es/row"),require("antd/es/col"),require("antd/es/tabs"),require("antd/es/list")):"function"==typeof define&&define.amd?define(["antd/es/layout","react","react-dnd","react-dnd-html5-backend","antd/es/modal","antd/es/button","mobx-react","antd/es/divider","antd/es/empty","antd/es/input-number","antd/es/checkbox","antd/es/select","antd/es/input","antd/es/radio","antd/es/message","mobx","shortid","immutability-helper","classnames","antd/es/row","antd/es/col","antd/es/tabs","antd/es/list"],t):(e=e||self).ReactFormEditor=t(e._Layout,e.React,e.ReactDnD,e.ReactDnDHTML5Backend,e._Modal,e._Button,e.mobxReact,e._Divider,e._Empty,e._InputNumber,e._Checkbox,e._Select,e._Input,e._Radio,e._message,e.mobx,e.shortid,e.update,e.classnames,e._Row,e._Col,e._Tabs,e._List)}(this,(function(e,t,n,a,r,l,i,u,o,c,s,m,d,f,p,v,E,b,h,y,g,O,T){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var N,C,x,A,w="default"in t?t.default:t;function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function S(e,t,n){return t&&k(e.prototype,t),n&&k(e,n),e}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){R(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function W(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function L(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q(e){return function(){var t,n=U(e);if(W()){var a=U(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return L(this,t)}}function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,l=void 0;try{for(var i,u=e[Symbol.iterator]();!(a=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,l=e}finally{try{a||null==u.return||u.return()}finally{if(r)throw l}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function H(e,t,n,a){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(a):void 0})}function V(e,t,n,a,r){var l={};return Object.keys(a).forEach((function(e){l[e]=a[e]})),l.enumerable=!!l.enumerable,l.configurable=!!l.configurable,("value"in l||l.initializer)&&(l.writable=!0),l=n.slice().reverse().reduce((function(n,a){return a(e,t,n)||n}),l),r&&void 0!==l.initializer&&(l.value=l.initializer?l.initializer.call(r):void 0,l.initializer=void 0),void 0===l.initializer&&(Object.defineProperty(e,t,l),l=null),l}a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o,c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,m=m&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m,d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d,f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f,p=p&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p,b=b&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b,h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h,y=y&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y,g=g&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g,O=O&&Object.prototype.hasOwnProperty.call(O,"default")?O.default:O,T=T&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T,function(e){e.TEXT="text",e.INPUT="input",e.NUMBER="number",e.TEXTAREA="textarea",e.CHECKBOX="checkbox",e.RADIO="radio",e.SELECT="select",e.LAYOUT="layout",e.RESULT="result"}(A||(A={}));var _=function(e){return{value:e,text:e}};var K=new(C=V((N=function(){function e(){I(this,e),H(this,"items",C,this),H(this,"activeId",x,this)}return S(e,[{key:"setItems",value:function(e){this.items=e,this.activeId=""}},{key:"getItems",value:function(){return this.items.slice(0)}},{key:"add",value:function(e){if(e===A.RESULT&&this.items.filter((function(e){return e.itemType===A.RESULT})).length>0)p.error("检验结果字段只能有一个");else{var t=function(e){var t=E.generate();switch(e){case A.RESULT:return{id:t,itemType:e,labelText:"检验结果"};case A.TEXT:return{id:t,itemType:e,content:"文字内容",fontSize:14,lineHeight:21,textAlign:"left"};case A.LAYOUT:return{id:t,itemType:e,rows:[[{span:12},{span:12}]]};case A.SELECT:return{id:t,itemType:e,labelText:"下拉选择框",options:[_("选项 1"),_("选项 2"),_("选项 3")],defaultValue:"选项 1"};case A.RADIO:return{id:t,itemType:e,labelText:"单选框",options:[_("选项 1"),_("选项 2")],buttonStyle:"solid",defaultValue:"",required:!0};case A.CHECKBOX:return{id:t,itemType:e,labelText:"多选框",options:[_("选项 1")],defaultValue:[],required:!0};case A.TEXTAREA:return{id:t,itemType:e,labelText:"文本域",placeholder:"文本域输入提示",defaultValue:"",required:!0};case A.NUMBER:return{id:t,itemType:e,labelText:"数字框",defaultValue:1,min:1,max:100,unit:""};default:return{id:t,itemType:A.INPUT,labelText:"文本框",placeholder:"文本框输入提示",defaultValue:"",required:!0}}}(e);this.items.push(t)}}},{key:"delete",value:function(e){this.items=this.items.filter((function(t){return t.id!==e}))}},{key:"update",value:function(e){this.items=this.items.map((function(t){return t.id===e.id?e:t}))}},{key:"activate",value:function(e){this.items.filter((function(t){return t.id===e})).length>0&&(this.activeId=e)}},{key:"move",value:function(e,t){var n=this.items[e];this.items=b(this.items,{$splice:[[e,1],[t,0,n]]})}},{key:"addOption",value:function(e){this.items=this.items.map((function(t){if(t.id===e&&[A.CHECKBOX,A.RADIO,A.SELECT].indexOf(t.itemType)>-1){t.options.push(_(""))}return t}))}},{key:"deleteOption",value:function(e,t){this.items=this.items.map((function(n){return n.id===e&&[A.CHECKBOX,A.RADIO,A.SELECT].indexOf(n.itemType)>-1&&(n.options.length>1?(n.options.splice(t,1),A.SELECT===n.itemType&&(n.defaultValue=n.options[0].value),A.CHECKBOX===n.itemType&&(n.defaultValue=[]),A.RADIO===n.itemType&&(n.defaultValue="")):p.error("选项不得少于 1 个")),n}))}},{key:"updateOption",value:function(e,t,n){this.items=this.items.map((function(a){return a.id===e&&[A.CHECKBOX,A.RADIO,A.SELECT].indexOf(a.itemType)>-1&&a.options.splice(t,1,_(n)),a}))}},{key:"setCheckboxDefaultOption",value:function(e,t){this.items=this.items.map((function(n){return n.id===e&&A.CHECKBOX===n.itemType&&(n.defaultValue=t),n}))}},{key:"setRadioDefaultOption",value:function(e,t){this.items=this.items.map((function(n){return n.id===e&&A.RADIO===n.itemType&&(n.defaultValue=t),n}))}},{key:"setSelectDefaultOption",value:function(e,t){this.items=this.items.map((function(n){return n.id===e&&A.SELECT===n.itemType&&(n.defaultValue=t),n}))}},{key:"addCol",value:function(e,t){this.items=this.items.map((function(n){return n.id===e&&A.LAYOUT===n.itemType&&n.rows[t].push({span:12}),n}))}},{key:"updateColSpan",value:function(e,t,n,a){this.items=this.items.map((function(r){return r.id===e&&A.LAYOUT===r.itemType&&r.rows[t].splice(n,1,{span:a}),r}))}},{key:"deleteCol",value:function(e,t,n){this.items=this.items.map((function(a){return a.id===e&&A.LAYOUT===a.itemType&&a.rows[t].splice(n,1),a}))}},{key:"updateTextItem",value:function(e,t,n,a,r){this.items=this.items.map((function(l){return l.id===e&&A.TEXT===l.itemType&&(l.content=t,l.fontSize=n,l.lineHeight=a,l.textAlign=r),l}))}},{key:"setRequired",value:function(e,t){this.items=this.items.map((function(n){return n.id===e&&(n.required=t),n}))}},{key:"formItems",get:function(){var e=this;return this.items.map((function(t){return j({},t,{isActive:t.id===e.activeId})}))}},{key:"activeItem",get:function(){return function(e,t){for(var n=null,a=0,r=e.length;a<r;a++){var l=e[a];if(l.id===t){n=l;break}}return n||{}}(this.items,this.activeId)}}]),e}()).prototype,"items",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=V(N.prototype,"activeId",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),N),F=function(e){return{values:e.reduce((function(e,t){return[A.INPUT,A.TEXTAREA,A.RADIO,A.CHECKBOX,A.SELECT].indexOf(t.itemType)>-1?j({},e,R({},t.id,t.defaultValue)):e}),{}),result:-1,comment:""}};function M(e){var n=e.form,a=n.items,r=n.attrs,i=r.formWidth,p=r.formWidthUnit,v=r.labelAlign,E=r.labelWidth,b=X(t.useState(F(a)),2),y=b[0],g=b[1],O=X(t.useState({result:!1,errors:{}}),2),T=O[0],N=O[1],C=X(t.useState(0),2),x=C[0],I=C[1];return 0===a.length?w.createElement(o,null):w.createElement("div",{className:"generated-form",style:{width:"".concat(i).concat(p)}},a.map((function(e,t){var n=e.itemType;if(n===A.TEXT){var a=e;return w.createElement("div",{key:t,className:"form-item form-item-text",style:{fontSize:a.fontSize,lineHeight:"".concat(a.lineHeight,"px"),textAlign:a.textAlign}},w.createElement("div",{className:"form-item-label"},a.content))}if([A.INPUT,A.NUMBER,A.TEXTAREA,A.RADIO,A.CHECKBOX,A.SELECT,A.RESULT].indexOf(n)>-1){var r=T.errors[e.id];return w.createElement("div",{className:h("form-item","top"===v?"label-standalone":""),key:t},w.createElement("div",{className:"form-item-label",style:j({width:E},"top"!==v?{textAlign:v}:{})},e.labelText),w.createElement("div",{className:"form-item-content"},function(e){switch(e.itemType){case A.RESULT:return w.createElement("div",null,w.createElement(f.Group,{style:{height:32,lineHeight:"32px",marginBottom:16},value:y.result,onChange:function(e){return g(j({},y,{result:e.target.value}))}},w.createElement(f,{value:1},"合格"),w.createElement(f,{value:0},"不合格"),w.createElement("span",{className:"err-msg"},x>0&&-1===y.result?"检验结果为必填项":"")),w.createElement(d.TextArea,{placeholder:"备注",value:y.comment,onChange:function(e){return g(j({},y,{comment:e.target.value}))}}));case A.SELECT:var t=e;return w.createElement(m,{value:y.values[t.id],onChange:function(e){var n=y.values;g(j({},y,{values:j({},n,R({},t.id,e))}))},style:{width:"100%"}},t.options.map((function(e,t){return w.createElement(m.Option,{key:t,value:e.value},e.text)})));case A.CHECKBOX:var n=e;return w.createElement(s.Group,{value:y.values[n.id],onChange:function(e){var t=y.values;g(j({},y,{values:j({},t,R({},n.id,e))}))}},n.options.map((function(e,t){return w.createElement(s,{key:t,value:e.value},e.text)})));case A.RADIO:var a=e;return w.createElement(f.Group,{value:y.values[a.id],onChange:function(e){var t=y.values;g(j({},y,{values:j({},t,R({},a.id,e.target.value))}))},buttonStyle:a.buttonStyle},a.options.map((function(e,t){return w.createElement(f.Button,{key:t,value:e.value},e.text)})));case A.TEXTAREA:var r=e;return w.createElement(d.TextArea,{value:y.values[r.id],onChange:function(e){var t=y.values;g(j({},y,{values:j({},t,R({},r.id,e.target.value))}))},placeholder:r.placeholder});case A.NUMBER:var l=e;return w.createElement(c,{style:{width:"100%"},value:y.values[l.id],onChange:function(e){e=e||l.min;var t=y.values;g(j({},y,{values:j({},t,R({},l.id,e))}))},min:l.min,max:l.max,formatter:function(e){return e?"".concat(e," ").concat(l.unit):"".concat(l.min," ").concat(l.unit)},parser:function(e){return Number(e?e.replace(" ".concat(l.unit),""):l.min)}});default:var i=e;return w.createElement(d,{value:y.values[i.id],onChange:function(e){var t=y.values;g(j({},y,{values:j({},t,R({},i.id,e.target.value))}))},placeholder:i.placeholder})}}(e),w.createElement("div",{className:"err-msg"},r)))}return null})),w.createElement(u,null),w.createElement("div",{style:{paddingLeft:E}},w.createElement(l,{type:"primary",onClick:function(){console.log("form items =>",a),console.log("form values =>",y);var t=function(e,t){var n=t.values;return e.reduce((function(e,a){var r=e.result,l=e.errors;if(function(e){return[A.INPUT,A.TEXTAREA,A.CHECKBOX,A.RADIO].indexOf(e.itemType)>-1}(a)&&a.required){var i=a,u=i.id,o=i.labelText,c=n[u];("string"==typeof c&&""===c||"[object Array]"===Object.prototype.toString.call(c)&&0===c.length)&&(l[u]="".concat(o,"为必填项"),r=!1)}return a.itemType===A.RESULT&&t.result,{result:r,errors:l}}),{result:!1,errors:{}})}(a,y);console.log(t),t.result?(e.onSubmit&&e.onSubmit(y),N({result:!1,errors:{}}),g(F(a))):N(t),I(x+1)},style:{width:90,marginRight:16}},"提 交"),w.createElement(l,{type:"default",onClick:function(){return g(F(a))},style:{width:90}},"重 置")))}var G=i.observer((function(e){var n=e.form,a=e.formAttrs,i=e.onSave,u=X(t.useState(!1),2),o=u[0],c=u[1],s=function(){return JSON.stringify({items:n.getItems(),attrs:a})};return w.createElement("div",{className:"form-editor-toolbar-content"},w.createElement(l,{type:"link",icon:"eye",onClick:function(){c(!0)}},"预览"),w.createElement(l,{type:"link",icon:"save",onClick:function(){return i(s())}},"保存"),w.createElement(r,{title:"表单预览",centered:!0,visible:o,onCancel:function(){return c(!1)},footer:null,width:800},o?w.createElement(M,{form:JSON.parse(s())}):null))})),Y="field",J="eidtable_field";var $,Q=i.observer((function(e){var t=e.name,a=e.text,r=X(n.useDrag({item:{name:t,type:Y},collect:function(e){return{isDragging:e.isDragging()}}}),2),l=r[0].isDragging,i=r[1];return w.createElement("div",{ref:i,className:"field",style:{opacity:l?.4:1}},a)})),Z=[{name:"input",text:"文本框"},{name:"number",text:"数字框"},{name:"textarea",text:"文本域"},{name:"radio",text:"单选框"},{name:"checkbox",text:"多选框"},{name:"select",text:"下拉选择框"},{name:"text",text:"文字"}],ee=[{name:"result",text:"检验结果"}];function te(){var e=function(e,t){return w.createElement("div",null,w.createElement("div",{className:"label"},e),t.map((function(e,t,n){if(t%2==0){var a=n.slice(t,t+2);return w.createElement(y,{gutter:10,key:t},a.map((function(e,n){return w.createElement(g,{span:12,key:"".concat(t,"-").concat(n)},w.createElement(Q,{name:e.name,text:e.text}))})))}return null})))};return w.createElement(w.Fragment,null,e("通用字段",Z),e("自定义字段",ee))}var ne,ae,re,le,ie,ue,oe=i.observer($=function(e){P(n,e);var t=q(n);function n(){return I(this,n),t.apply(this,arguments)}return S(n,[{key:"render",value:function(){var e=this.props.formAttrs;return w.createElement("div",{className:"attrs"},w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"表单宽度"),w.createElement(c,{className:"input",value:e.formWidth,min:0,step:1,onChange:function(t){void 0!==t&&(e.formWidth=t)}})),w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"表单宽度单位"),w.createElement(f.Group,{className:"input",value:e.formWidthUnit,buttonStyle:"solid",onChange:function(t){e.formWidthUnit=t.target.value}},w.createElement(f.Button,{value:"%"},"百分比 %"),w.createElement(f.Button,{value:"px"},"像素 px "))),w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"标签宽度"),w.createElement(c,{className:"input",value:e.labelWidth,min:0,step:1,onChange:function(t){void 0!==t&&(e.labelWidth=t)}})),w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"标签宽度单位"),w.createElement(f.Group,{className:"input",value:e.labelWidthUnit,buttonStyle:"solid",onChange:function(t){e.labelWidthUnit=t.target.value}},w.createElement(f.Button,{value:"%"},"百分比 %"),w.createElement(f.Button,{value:"px"},"像素 px "))),w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"标签对齐方式"),w.createElement(f.Group,{className:"input",value:e.labelAlign,buttonStyle:"solid",onChange:function(t){e.labelAlign=t.target.value}},w.createElement(f.Button,{value:"left"},"左对齐"),w.createElement(f.Button,{value:"right"},"右对齐"),w.createElement(f.Button,{value:"top"},"顶部对齐"))))}}]),n}(w.Component))||$,ce=new(ae=V((ne=function(){function e(){I(this,e),H(this,"formWidth",ae,this),H(this,"formWidthUnit",re,this),H(this,"labelAlign",le,this),H(this,"labelWidth",ie,this),H(this,"labelWidthUnit",ue,this)}return S(e,[{key:"reset",value:function(e){this.formWidth=e.formWidth||100,this.labelAlign=e.labelAlign||"left",this.labelWidth=e.labelWidth||100,this.labelWidthUnit=e.labelWidthUnit||"px"}},{key:"formWidthString",get:function(){return"".concat(this.formWidth).concat(this.formWidthUnit)}},{key:"labelWidthString",get:function(){return"".concat(this.labelWidth).concat(this.labelWidthUnit)}}]),e}()).prototype,"formWidth",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),re=V(ne.prototype,"formWidthUnit",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"%"}}),le=V(ne.prototype,"labelAlign",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"left"}}),ie=V(ne.prototype,"labelWidth",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),ue=V(ne.prototype,"labelWidthUnit",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"px"}}),V(ne.prototype,"formWidthString",[v.computed],Object.getOwnPropertyDescriptor(ne.prototype,"formWidthString"),ne.prototype),V(ne.prototype,"labelWidthString",[v.computed],Object.getOwnPropertyDescriptor(ne.prototype,"labelWidthString"),ne.prototype),ne);var se=i.observer((function(e){var t=e.form,n=t.activeItem,a=n.id,r=n.itemType,i=t.activeItem.labelText;function u(e){t.update(e)}var o,s=function(e){return w.createElement(w.Fragment,null,w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"输入提示"),w.createElement(d,{className:"input",value:e.placeholder,onChange:function(t){return u(j({},e,{placeholder:t.target.value}))}})),w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"默认值"),w.createElement(d,{className:"input",value:e.defaultValue,onChange:function(t){return u(j({},e,{defaultValue:t.target.value}))}})))},p=function(e){var n=e.options;return w.createElement(w.Fragment,null,w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"选项"),w.createElement(T,{size:"small",itemLayout:"horizontal",dataSource:n,renderItem:function(n,a){return w.createElement(T.Item,{key:a},w.createElement("div",{className:"attr-item-option"},w.createElement(d,{value:n.value,onChange:function(n){t.updateOption(e.id,a,n.target.value)}}),w.createElement(l,{type:"danger",icon:"delete",className:"btn-delete-option",onClick:function(){return t.deleteOption(e.id,a)}},"删除")))}}),w.createElement(l,{type:"primary",onClick:function(){return t.addOption(e.id)},icon:"plus"},"添加选项")))},v=[A.INPUT,A.NUMBER,A.TEXTAREA,A.CHECKBOX,A.RADIO,A.SELECT].indexOf(r)>-1,E=[A.INPUT,A.TEXTAREA,A.CHECKBOX,A.RADIO].indexOf(r)>-1;return w.createElement("div",{className:"attrs"},w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"标识"),w.createElement(d,{className:"input",value:a,disabled:!0})),v?w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"标签文字"),w.createElement(d,{className:"input",value:i,onChange:function(e){return u(j({},t.activeItem,{},{labelText:e.target.value}))}})):null,r===A.INPUT?s(t.activeItem):null,r===A.NUMBER?(o=t.activeItem,w.createElement(w.Fragment,null,w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"最小值"),w.createElement(c,{className:"input",value:o.min,onChange:function(e){return u(j({},o,{min:Number(e)}))}})),w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"最大值"),w.createElement(c,{className:"input",value:o.max,onChange:function(e){return u(j({},o,{max:Number(e)}))}})),w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"默认值"),w.createElement(c,{className:"input",value:o.defaultValue,min:o.min,max:o.max,onChange:function(e){return u(j({},o,{defaultValue:Number(e)}))}})),w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"单位"),w.createElement(d,{className:"input",value:o.unit,onChange:function(e){return u(j({},o,{unit:e.target.value}))}})))):null,r===A.TEXTAREA?s(t.activeItem):null,r===A.CHECKBOX?p(t.activeItem):null,r===A.CHECKBOX?function(e){return w.createElement(w.Fragment,null,w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"默认值"),w.createElement(m,{mode:"tags",value:e.defaultValue,style:{width:"100%"},onChange:function(n){return t.setCheckboxDefaultOption(e.id,n)}},e.options.map((function(e,t){return w.createElement(m.Option,{key:t,value:e.value},e.value)})))))}(t.activeItem):null,r===A.RADIO?p(t.activeItem):null,r===A.RADIO?function(e){return w.createElement(w.Fragment,null,w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"默认值"),w.createElement(m,{value:e.defaultValue,style:{width:"100%"},onChange:function(n){return t.setRadioDefaultOption(e.id,n)}},e.options.map((function(e,t){return w.createElement(m.Option,{key:t,value:e.value},e.value)})))))}(t.activeItem):null,r===A.SELECT?p(t.activeItem):null,r===A.SELECT?function(e){return w.createElement(w.Fragment,null,w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"默认值"),w.createElement(m,{value:e.defaultValue,style:{width:"100%"},onChange:function(n){return t.setSelectDefaultOption(e.id,n)}},e.options.map((function(e,t){return w.createElement(m.Option,{key:t,value:e.value},e.value)})))))}(t.activeItem):null,r===A.LAYOUT?function(e){var n=e.rows;return w.createElement(w.Fragment,null,n.map((function(n,a){return w.createElement("div",{className:"attr-item",key:a},w.createElement("div",{className:"label"},"列宽"),w.createElement(T,{size:"small",itemLayout:"horizontal",dataSource:n,renderItem:function(n,r){return w.createElement(T.Item,{key:r},w.createElement("div",{className:"attr-item-option"},w.createElement(c,{className:"input",value:n.span,min:1,max:24,step:1,onChange:function(n){t.updateColSpan(e.id,a,r,Number(n))}}),w.createElement(l,{type:"danger",icon:"delete",className:"btn-delete-option",onClick:function(){return t.deleteCol(e.id,a,r)}},"删除")))}}),w.createElement(l,{type:"primary",onClick:function(){return t.addCol(e.id,a)},icon:"plus"},"添加列"))})))}(t.activeItem):null,r===A.TEXT?function(e){var n=e.id,a=e.content,r=e.fontSize,l=e.lineHeight,i=e.textAlign;return w.createElement(w.Fragment,null,w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"文字内容"),w.createElement(d.TextArea,{value:a,onChange:function(e){return t.updateTextItem(n,e.target.value,r,l,i)}})),w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"文字大小"),w.createElement(c,{className:"input",value:r,min:12,max:100,step:1,onChange:function(e){return t.updateTextItem(n,a,Number(e),l,i)}})),w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"文字行高"),w.createElement(c,{className:"input",value:l,min:12,max:100,step:1,onChange:function(e){return t.updateTextItem(n,a,r,Number(e),i)}})),w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"对齐方式"),w.createElement(m,{style:{width:"100%"},value:i,onChange:function(e){return t.updateTextItem(n,a,r,l,e)}},w.createElement(m.Option,{value:"left"},"左对齐"),w.createElement(m.Option,{value:"right"},"右对齐"),w.createElement(m.Option,{value:"center"},"居中"))))}(t.activeItem):null,E?function(e){return w.createElement(w.Fragment,null,w.createElement("div",{className:"attr-item"},w.createElement("div",{className:"label"},"是否必填"),w.createElement(f.Group,{value:e.required,onChange:function(n){return t.setRequired(e.id,n.target.value)}},w.createElement(f,{value:!0},"必填"),w.createElement(f,{value:!1},"选填"))))}(t.activeItem):null)})),me=O.TabPane,de=function(e){P(n,e);var t=q(n);function n(){var e;I(this,n);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).onChangeTab=function(e){},e}return S(n,[{key:"render",value:function(){return w.createElement(O,{onChange:this.onChangeTab,animated:!1},w.createElement(me,{tab:"字段属性",key:"field-attrs"},w.createElement(se,{form:K})),w.createElement(me,{tab:"表单属性",key:"form-attrs"},w.createElement(oe,{formAttrs:ce})))}}]),n}(w.Component);var fe=i.observer((function(e){var a=e.formItem,r=e.formItemIndex,i=e.moveFormItem,u=t.useRef(null),o=X(n.useDrop({accept:[J],hover:function(e,t){if(null!==u.current){var n=e.index,a=r;if(n!==a){var l=u.current.getBoundingClientRect(),o=(l.bottom-l.top)/2,c=t.getClientOffset();if(null!==c){var s=c.y-l.top;n<a&&s<o||n>a&&s>o||(i(n,a),e.index=a)}}}}}),2)[1],p=X(n.useDrag({item:{index:r,type:J},collect:function(e){return{isDragging:e.isDragging()}}}),2),v=p[0].isDragging;return(0,p[1])(o(u)),a.itemType===A.LAYOUT?w.createElement("div",{ref:u,className:h("field-editable field-editable-layout",a.isActive?"field-editable-active":""),style:{opacity:v?.4:1},onMouseDown:function(){return K.activate(a.id)}},a.rows.map((function(e,t){return w.createElement(y,{key:t,gutter:5},e.map((function(e,t){return w.createElement(g,{key:t,span:e.span})})))})),w.createElement(l,{className:"btn-delete",type:"danger",size:"small",icon:"delete",onClick:function(){return K.delete(a.id)}},"删除")):a.itemType===A.TEXT?w.createElement("div",{ref:u,className:h("field-editable field-editable-text",a.isActive?"field-editable-active":""),style:{opacity:v?.4:1},onMouseDown:function(){return K.activate(a.id)}},w.createElement("div",{style:{fontSize:a.fontSize,lineHeight:"".concat(a.lineHeight,"px"),textAlign:a.textAlign}},a.content),w.createElement(l,{className:"btn-delete",type:"danger",size:"small",icon:"delete",onClick:function(){return K.delete(a.id)}},"删除")):w.createElement("div",{ref:u,className:h("field-editable","top"===ce.labelAlign?"label-standalone":"",a.isActive?"field-editable-active":""),style:{opacity:v?.4:1},onMouseDown:function(){return K.activate(a.id)}},w.createElement("div",{className:h("field-editable-label","top"===ce.labelAlign?"field-standalone":""),style:j({width:ce.labelWidth},"top"!==ce.labelAlign?{textAlign:ce.labelAlign}:{})},a.labelText),w.createElement("div",{className:"field-editable-content"},function(e){switch(e.itemType){case A.RESULT:return w.createElement("div",null,w.createElement(f.Group,{value:"合格",style:{height:32,lineHeight:"32px",marginBottom:16}},w.createElement(f,{value:"合格"},"合格"),w.createElement(f,{value:"不合格"},"不合格")),w.createElement(d.TextArea,{value:"",placeholder:"备注"}));case A.SELECT:var t=e;return w.createElement(m,{value:t.defaultValue,style:{width:"100%"}},t.options.map((function(e,t){return w.createElement(m.Option,{key:t,value:e.value},e.text)})));case A.CHECKBOX:var n=e;return w.createElement(s.Group,{value:n.defaultValue},n.options.map((function(e,t){return w.createElement(s,{key:t,value:e.value},e.text)})));case A.RADIO:var a=e;return w.createElement(f.Group,{value:a.defaultValue,buttonStyle:a.buttonStyle},a.options.map((function(e,t){return w.createElement(f.Button,{key:t,value:e.value},e.text)})));case A.TEXTAREA:var r=e;return w.createElement(d.TextArea,{value:r.defaultValue,placeholder:r.placeholder});case A.NUMBER:var l=e;return w.createElement(c,{style:{width:"100%"},value:l.defaultValue,formatter:function(e){return e?"".concat(e," ").concat(l.unit):"".concat(l.min," ").concat(l.unit)},parser:function(e){return Number(e?e.replace(" ".concat(l.unit),""):l.min)}});default:var i=e;return w.createElement(d,{value:i.defaultValue||"",placeholder:i.placeholder})}}(a)),w.createElement(l,{className:"btn-delete",type:"danger",size:"small",icon:"delete",onClick:function(){return K.delete(a.id)}},"删除"))}));var pe=i.observer((function(e){var a=e.formAttrs,r=e.form,l=t.useCallback((function(e,t){return r.move(e,t)}),[r.formItems]),i=X(n.useDrop({accept:[Y],drop:function(e,t){e.type===Y&&r.add(e.name)},collect:function(e){return{isOver:e.isOver(),canDrop:e.canDrop()}}}),2),u=i[0],o=(u.isOver,u.canDrop,i[1]);return w.createElement("div",{ref:o,className:"editable-form",style:{width:a.formWidthString}},r.formItems.map((function(e,t){return w.createElement(fe,{key:e.id,formItem:e,formItemIndex:t,moveFormItem:l})})))})),ve=e.Header,Ee=e.Content,be=e.Sider;return function(r){var l=r.style,i=r.defaultFormItems,u=void 0===i?[]:i,o=r.defaultFormAttrs,c=r.onSave,s=void 0===c?console.log:c;return t.useEffect((function(){K.setItems(u),o&&ce.reset(o)}),[]),w.createElement(n.DndProvider,{backend:a},w.createElement(e,{className:"form-editor",style:l},w.createElement(be,{theme:"light",className:"form-editor-components"},w.createElement(te,null)),w.createElement(e,{className:"form-editor-content"},w.createElement(e,{className:"form-editor-content-main"},w.createElement(ve,{className:"form-editor-toolbar"},w.createElement(G,{formAttrs:ce,form:K,onSave:s})),w.createElement(Ee,{className:"form-editor-editarea"},w.createElement(pe,{formAttrs:ce,form:K}))),w.createElement(be,{theme:"light",width:300,className:"form-editor-content-attrs"},w.createElement(de,null)))))}}));
